__d(function(g,r,i,a,m,e,d){'use strict';var t='ws://localhost:5555/',n='http://localhost:5556/',s=['close','error','message','open'],o=['CONNECTING','OPEN','CLOSING','CLOSED'],l=(function(t){function n(){return r(d[1])(this,n),r(d[2])(this,r(d[3])(n).apply(this,arguments))}return r(d[0])(n,t),r(d[4])(n,[{key:"render",value:function(){var t=r(d[5]).createElement(r(d[6]).Text,{style:f.buttonLabel},this.props.label);return this.props.disabled?r(d[5]).createElement(r(d[6]).View,{style:[f.button,f.disabledButton]},t):r(d[5]).createElement(r(d[6]).TouchableOpacity,{onPress:this.props.onPress,style:f.button},t)}}]),n})(r(d[5]).Component),c=(function(t){function n(){return r(d[1])(this,n),r(d[2])(this,r(d[3])(n).apply(this,arguments))}return r(d[0])(n,t),r(d[4])(n,[{key:"render",value:function(){return r(d[5]).createElement(r(d[6]).View,{style:f.row},r(d[5]).createElement(r(d[6]).Text,null,this.props.label),this.props.value?r(d[5]).createElement(r(d[6]).Text,null,this.props.value):null,this.props.children)}}]),n})(r(d[5]).Component),u=(function(t){function n(){var t,s;r(d[1])(this,n);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return(s=r(d[2])(this,(t=r(d[3])(n)).call.apply(t,[this].concat(l)))).ws=null,s.state={blob:null},s}return r(d[0])(n,t),r(d[4])(n,[{key:"componentDidMount",value:function(){var t=this,n=this.ws=new WebSocket(this.props.url);n.binaryType='blob',n.onmessage=function(n){if(n.data instanceof Blob){var s=n.data;t.state.blob&&t.state.blob.close(),t.setState({blob:s})}},n.onopen=function(t){n.send('getImage')}}},{key:"componentUnmount",value:function(){this.state.blob&&this.state.blob.close(),this.ws&&this.ws.close()}},{key:"render",value:function(){return this.state.blob?r(d[5]).createElement(r(d[6]).Image,{source:{uri:URL.createObjectURL(this.state.blob)},style:{width:50,height:50}}):r(d[5]).createElement(r(d[6]).View,null)}}]),n})(r(d[5]).Component);function h(t){return void 0===t||null===t?'(no value)':'undefined'!=typeof ArrayBuffer&&'undefined'!=typeof Uint8Array&&t instanceof ArrayBuffer?"ArrayBuffer {"+String(Array.from(new Uint8Array(t)))+"}":t}var b=(function(b){function p(){var o,l;r(d[1])(this,p);for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];return(l=r(d[2])(this,(o=r(d[3])(p)).call.apply(o,[this].concat(u)))).state={url:t,httpUrl:n,fetchStatus:null,socket:null,socketState:null,lastSocketEvent:null,lastMessage:null,outgoingMessage:''},l._connect=function(){var t=new WebSocket(l.state.url);s.forEach(function(n){return t.addEventListener(n,l._onSocketEvent)}),l.setState({socket:t,socketState:t.readyState})},l._disconnect=function(){l.state.socket&&l.state.socket.close()},l._onSocketEvent=function(t){var n={socketState:t.target.readyState,lastSocketEvent:t.type};'message'===t.type&&(n.lastMessage=t.data),l.setState(n)},l._sendText=function(){l.state.socket&&(l.state.socket.send(l.state.outgoingMessage),l.setState({outgoingMessage:''}))},l._sendHttp=function(){l.setState({fetchStatus:'fetching'}),fetch(l.state.httpUrl).then(function(t){t.status>=200&&t.status<400&&l.setState({fetchStatus:'OK'})})},l._sendBinary=function(){if(l.state.socket&&'undefined'!=typeof ArrayBuffer&&'undefined'!=typeof Uint8Array){for(var t=l.state.outgoingMessage,n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);l.state.socket.send(n),l.setState({outgoingMessage:''})}},l}return r(d[0])(p,b),r(d[4])(p,[{key:"render",value:function(){var t=this,n=o[this.state.socketState||-1],s=!this.state.socket||this.state.socket.readyState>=WebSocket.CLOSING,b='OPEN'===n;return r(d[5]).createElement(r(d[6]).ScrollView,{style:f.container},r(d[5]).createElement(r(d[6]).View,{style:f.note},r(d[5]).createElement(r(d[6]).Text,null,"To start the WS test server:"),r(d[5]).createElement(r(d[6]).Text,{style:f.monospace},"./RNTester/js/websocket_test_server.js")),r(d[5]).createElement(c,{label:"Current WebSocket state",value:h(n)}),r(d[5]).createElement(c,{label:"Last WebSocket event",value:h(this.state.lastSocketEvent)}),r(d[5]).createElement(c,{label:"Last message received",value:h(this.state.lastMessage)}),r(d[5]).createElement(c,{label:"Last image received"},b?r(d[5]).createElement(u,{url:this.state.url}):null),r(d[5]).createElement(r(d[6]).TextInput,{style:f.textInput,autoCorrect:!1,placeholder:"Server URL...",onChangeText:function(n){return t.setState({url:n})},value:this.state.url}),r(d[5]).createElement(r(d[6]).View,{style:f.buttonRow},r(d[5]).createElement(l,{onPress:this._connect,label:"Connect",disabled:!s}),r(d[5]).createElement(l,{onPress:this._disconnect,label:"Disconnect",disabled:s})),r(d[5]).createElement(r(d[6]).TextInput,{style:f.textInput,autoCorrect:!1,placeholder:"Type message here...",onChangeText:function(n){return t.setState({outgoingMessage:n})},value:this.state.outgoingMessage}),r(d[5]).createElement(r(d[6]).View,{style:f.buttonRow},r(d[5]).createElement(l,{onPress:this._sendText,label:"Send as text",disabled:!b}),r(d[5]).createElement(l,{onPress:this._sendBinary,label:"Send as binary",disabled:!b})),r(d[5]).createElement(r(d[6]).View,{style:f.note},r(d[5]).createElement(r(d[6]).Text,null,"To start the HTTP test server:"),r(d[5]).createElement(r(d[6]).Text,{style:f.monospace},"./RNTester/js/http_test_server.js")),r(d[5]).createElement(r(d[6]).TextInput,{style:f.textInput,autoCorrect:!1,placeholder:"HTTP URL...",onChangeText:function(n){return t.setState({httpUrl:n})},value:this.state.httpUrl}),r(d[5]).createElement(r(d[6]).View,{style:f.buttonRow},r(d[5]).createElement(l,{onPress:this._sendHttp,label:"Send HTTP request to set cookie",disabled:'fetching'===this.state.fetchStatus})),r(d[5]).createElement(r(d[6]).View,{style:f.note},r(d[5]).createElement(r(d[6]).Text,null,'OK'===this.state.fetchStatus?'Done. Check your WS server console to see if the next WS requests include the cookie (should be "wstest=OK")':'-')))}}]),p})(r(d[5]).Component),f=r(d[6]).StyleSheet.create({container:{flex:1},note:{padding:8,margin:4,backgroundColor:'white'},monospace:{fontFamily:'courier',fontSize:11},row:{height:40,padding:4,backgroundColor:'white',flexDirection:'row',justifyContent:'space-between',alignItems:'center',borderBottomWidth:1/r(d[6]).PixelRatio.get(),borderColor:'grey'},button:{margin:8,padding:8,borderRadius:4,backgroundColor:'blue',alignSelf:'center'},disabledButton:{opacity:.5},buttonLabel:{color:'white'},buttonRow:{flexDirection:'row',justifyContent:'center'},textInput:{height:40,backgroundColor:'white',margin:8,padding:8}});e.title='WebSocket',e.description='WebSocket API',e.examples=[{title:'Basic websocket',render:function(){return r(d[5]).createElement(b,null)}}]},666791,[614,616,617,620,621,514,516]);